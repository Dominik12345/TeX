\section{HIO as graphical criterion}

Consider a dynamic system with matrices $A$, $B$, $C$ and $D$ with $n$ state variables, 
$p$ observables and $m$ hidden inputs. As before we neglect the known inputs via $B$. 
Now assume each hidden input affects the state variables $x_{i_1},x_{i_2},\ldots$ 
directly, that means the 
$\alpha$-th column of $D$ corresponds to $w_\alpha$ and can be represented by index set 
$\hat{D}_\alpha$ such that $a\in \hat{D}_\alpha$ means $w_\alpha$ hits $x_a$. 
The observable $y_\beta$ corresponds to the $\beta$-th row of $C$. For that we can write 
$y_\beta = \sum_{b\in\hat{C}_\beta}$ for an index set $\hat{C}_\beta$. \\

Before we deal with graphical HIO we collect basics of graph theory together with 
definitions convenient for HIO.

\subsection{Basics of Graph Theory}

\begin{definition}{Graphtheoretical Definitions}{}
\begin{enumerate}
	\item
	When we consider a dynamic system as network, the state variables $x_i$ shall be called 
	\textit{knots}.
	\item	
	Let $A$ be the matrix of the linear dynamic system. The \textit{path factor} of a 
	sequence $\pi=(x_{l_0},x_{l_1},\ldots,x_{l_N})$ is
	\begin{equation}
		F(\pi):=\prod\limits_{i=0}^{N-1} A_{l_{i+1}l_i} \quad . 
	\end{equation}
	\item
	We define a relation
	\begin{equation}
	x_a \sim x_b \quad \overset{ { \text{definition} } }{ \Longleftrightarrow } 
	F( (x_a,x_b) )\neq 0  \quad \left( \quad \Longleftrightarrow \quad A_{ba} \neq 0 \quad 
	\right)\quad .
	\end{equation}
	\item
	A \textit{path} from $x_a$ to $x_b$ is a sequence $(x_{l_0},x_{l_1},x_{l_2},
	\ldots,x_{l_N})$ with indices $l_i$ such that 
	\begin{equation}
	x_{l_0} = x_a \tab{,} x_{l_N} = x_b \tab{and} x_{l_i} \sim x_{l_{i+1}}	\quad .
	\end{equation}
	\item
	The \textit{length} of such a path is $||(x_{l_0},\ldots, x_{l_N} )||=N$. 
	\item	
	\begin{enumerate}
	\item
	For the \textit{set of all paths} from $x_a$ to $x_b$ we write $\Gamma(x_a,x_b)$.
	\item
	The \textit{set of paths of length $k$} from $x_a$ to $x_b$ is $\Gamma_k(x_a,x_b)$.
	\item
	For the \textit{shortest path} from $x_a$ to $x_b$ (if it exists) we write 
	$\gamma(x_a,x_b)$.
	\end{enumerate}
	\item
	The \textit{distance} between $x_a$ and $x_b$ is $d(x_a,x_b):=||\gamma(x_a,x_b)||$ if 	
	it exists. If there is no path from $x_a$ to $x_b$ we write $d(x_a,x_b)=\infty$.
	\item
	 \begin{enumerate}
	\item		
	The path $(x_a)$ is called \textit{trivial path}. 
	\item	
	The path $(x_a,x_a)$ is called \textit{self-loop}. 
	\item	
	Any path $(x_a,x_{l_1},\ldots,x_{l_{N-1}},x_a)$ is called 
	\textit{loop}. 
	\end{enumerate}
	\item	
	Let $\pi$ and $\pi'$ be paths. 
	\begin{enumerate} \item
	We write $x_i\in\pi$ if $x_i$ appears in $\pi$.
	\end{enumerate}
\end{enumerate}	
\end{definition}

\begin{definition}{}{}
	Let $\pi = (x_{l_0},\ldots,x_{l_N})$ and $\pi' = (x_{k_0},\ldots,x_{k_N'})$ be 
	sequences of knots.
	\begin{enumerate}
	\item 
	\begin{equation}
	\pi \odot \pi' := (x_{l_0},\ldots,x_{l_N},x_{k_0},\ldots,x_{k_N'})
	\end{equation}
	\item If $x_{l_N}=x_{k_0}$.
	\begin{equation}
	\pi \oplus \pi' := (x_{l_0},\ldots,x_{l_N},x_{k_1},\ldots,x_{k_N'})
	\end{equation}	
	\item
	We write 
	$\pi \subset \pi'$ if $\pi'=(x_{l_0},\ldots,x_{l_{N'}} ) \oplus \pi \oplus 
	(x_{l_{ N'+||\pi||} },\ldots,x_{l_N})$.
	\end{enumerate}
\end{definition}

\begin{lemma}{}{}
	\begin{enumerate}
	\item The path factor is a homomorphism, i.e. 
	\begin{equation}
	F(\pi\oplus \pi') = F(\pi) F(\pi') 
	\end{equation}	
	and 
	\begin{equation}
	F(\pi \odot \pi') = F(\pi) F( (x_{l_N},x_{k_0}))F(\pi') \quad . 
	\end{equation}
	\item For a sequence $\pi=(x_{l_0},\ldots,x_{l_N})$
	\begin{equation}
	F(\pi) \neq 0 \quad \Leftrightarrow \quad \text{ $\pi$ is a path} \quad .
	\end{equation}
	\end{enumerate}
\end{lemma}
\begin{proof}
	\begin{enumerate}
	\item
	Write down the definitions to see that these equations hold.
	\item
	Decompose $\pi = (x_{l_0},x_{l_1})\oplus (x_{l_1},x_{l_2})\oplus \ldots $ to see that 
	\begin{equation}
	F(\pi) = \prod\limits_{i=0}^{N-1} F(x_{l_{i}},x_{l_{i+1}}) = \prod\limits_{i=0}^{N-1}
	A_{l_{i+1}l_i} \quad .
	\end{equation}
	If and only if all factors $A_{l_{i+1}l_i}\neq 0$, then by definition $\pi$ is a path.
	\end{enumerate}
\end{proof}

\clearpage
\begin{lemma}{}{}
	Let $\pi$ be a path from $x_a$ to $x_b$.
	\begin{enumerate}
	\item For two paths $\pi$ and $\pi'$, $||\pi||+||\pi'|| = ||\pi\oplus \pi'||$. \\
	\textit{(Addition of path lengths)}
	\item If any $x_i$ appears more than once in $\pi$, then 
	$ \pi \neq \gamma(x_a,x_b)$. \\
	\textit{(Shortest paths contain no loops)}
	\item If there are $x_{l_i}, x_{l_j} \in \pi$ such that $x_{l_i}\sim x_{l_j}$ and 
	$j\neq i+1$,\\ then $\pi\neq \gamma(x_a,x_b)$.\\
	\textit{(No shortcuts for shortest paths)}
	\item Let $x_a$, $x_b$ ,$x_{a'}$ and $x_{b'}$ be knots. If $\pi$ is a path from 
	$x_{a'}$ to $x_{b'}$ and if $\pi\subset \gamma(x_a,x_b)$ then $\pi = \gamma(x_{a'},
	x_{b'} )$.\\
	\textit{(Subpaths of a shortest path are again a shortest path)}
	\end{enumerate}
\end{lemma}
\begin{proof}
	\begin{enumerate}
	\item Consider two paths $\pi = ( x_{l_0},\ldots,x_{l_N} )$ and $\pi'= (x_{k_0},\ldots,
	x_{k_{N'} } ) $ with the property $x_{l_N} = x_{k_0}$. Then 
	$\pi\oplus \pi' = (x_{l_0},\ldots,x_{l_N},x_{l_{N+1}},\ldots, x_{N+N'})$ with 
	$l_{N+i} = k_i$. We see that $||\pi||=N$, $||\pi'||=N'$ and $||\pi\oplus \pi'||=N+N'$.
	\item Assume $x_{l^*}$ appears twice in a path $\pi$ from $x_a$ to $x_b$. 
	Then we can write $\pi = \pi_1 \oplus \pi^* \oplus \pi_2$ such that $\pi_1$ is a 
	path from $x_a$ to $x_{l^*}$, $\pi^*$ is a nontrivial path from $x_{l^*}$ to $x_{l^*}$ 
	and $\pi_2$ is a path from $x_{l^*}$ to $x_b$. Thus also $\pi_1\oplus \pi_2$ is a path 
	from $x_a$ to $x_b$ and $||\pi_1\oplus\pi_2|| = ||\pi||-||\pi^*||$ which means $
	\pi_1\oplus \pi_2$ is shorter than $\pi$ and therefore $\pi$ cannot be the shortest 
	path $\gamma(a,b)$.
	\item We can write $\pi = \pi_1 \oplus \pi_2 \oplus \pi_3$ such that $\pi_1$ is from 
	$x_a$ to $x_{l_i}$, $\pi_2$ is from $x_{l_i}$ to $x_{l_j}$ and $\pi_3$ is from 
	$x_{l_j}$ to $x_b$. Since $x_{l_i}\sim x_{l_j}$ we can define 
	$\pi^* = \pi_1 \oplus (x_{l_i},x_{l_j})\oplus \pi_3 $. We see that 
	$||\pi^*||\leq ||\pi||$ and equality holds only if $||\pi_2||=1$ which means that 
	$l_j =l_{i+1}$ or equivalently $j=i+1$. Thus if $j\neq i+1$ we have found a shorter 
	path and  $\pi$ cannot be $\gamma(a,b)$.
	\item We can write $\gamma(x_a,x_b) = \pi_1 \oplus \pi \oplus \pi_2$ where $\pi_1$ is 
	from 
	$x_a$ to $x_{a'}$ and $\pi_2$ is from $x_{b'}$ to $x_b$. Now assume $\pi \neq 
	\gamma(x_{a'},x_{b'})$. Then $\pi^* = \pi_1\oplus \gamma(x_{a'},x_{b'}) \oplus \pi_2 $ 
	is shorter than $\gamma(x_a,x_b)$. This is in contradiction to the assumptions. 
 	\end{enumerate}
\end{proof}

\clearpage

\subsection{Structural Dynamic Networks}
%It is possible to get information about the matrices $M_q$ just by the properties of the network graph. We 
%firstly derive some pure qualitative properties, after that the complete information about $M_q$ will be given 
%in terms of paths and path factors.
%%
%%\begin{lemma}{}{}
%%	Consider $\gamma(x_a,x_b) = (x_a=x_{l_0},x_{l_1},
%%	\ldots,x_{l_{K-1}},x_{l_K} =x_b) $. Then
%%	\begin{equation}
%%	A^2_{l_{j}l_i} =\sum\limits_{\mu} A_{l_j \mu} A_{\mu l_i} =A_{l_j l_{i+1}} 
%%	A_{l_{i+1} l_i}
%%	  \left\{ \begin{matrix}
%%	\neq 0 \tab{if } j=i+2 \\ = 0 \tab{else}
%%\end{matrix}	\right. \quad .
%%	\end{equation}
%%\end{lemma}
%%\begin{proof}
%%	If there is a $\mu$ such that $x_{l_i}\sim x_\mu$ and 
%%	$x_\mu\sim x_{l_j}$ then consider \\$\pi = \gamma(x_a,x_{l_i}) \oplus (x_{l_i},x_\mu, 
%%	x_{l_j}) \oplus \gamma(x_{l_j},x_b)$. If and only if $\mu = l_{i+1} = l_{j-1}$ this is
%%	consistent with $\gamma(x_a,x_b)$ being the shortest path. \\
%%	
%%	Consider $j=i+2$. Then by the above argument only $\mu = l_{i+1}$ leads to\\ 
%%	$A_{l_j\mu}A_{\mu l_i} \neq 0$.\\
%%	
%%	Consider $j\neq i+2$. Then by the above argument for each $\mu$ we get \\ 
%%	$A_{l_j\mu}A_{\mu l_i} =0$.
%%\end{proof}
%\subsubsection*{Qualitative Properties}
%
%\begin{lemma}{}{}
%	Let $k\in\mathbb{N}$ and $x_a$, $x_b$ knots of a network. We consider $A$ as a 
%	structural matrix, i.e. we ignore special cases, in which different elements of 
%	$A$ exactly neutralise each other. Then
%	\begin{equation}
%	A^k_{ba} \neq 0 \quad \Leftrightarrow \quad \exists \text{ a path from } x_a 
%	\text{ to } x_b \text{ of length }k \quad .
%	\end{equation}
%\end{lemma}
%\begin{proof}
%	We write 
%	\begin{equation}
%	A^k_{ba} = \sum\limits_{l_1,l_2,\ldots,l_{k-1}=1}^n A_{b l_{k-1}} \ldots A_{l_2 l_1} 
%	A_{l_1 a} = \sum\limits_{\pi\in\Gamma_k(x_a,x_b)} F(\pi)
%	 \quad .
%	\end{equation}		
%	\begin{itemize}
%	\item If $\Gamma_k(x_a,x_b)=\emptyset$ then $A^k_{ba}=0$ since there is nothing to sum.
%	\item If $\Gamma_k(x_a,x_b)\neq\emptyset$ then there is at least one $F(\pi)\neq 0$ and 
%	since we consider structural properties this is sufficient to show that $A^k_{ba}\neq 
%	0$.
%	\end{itemize}		
%\end{proof}
%
%
%\begin{lemma}{}{}
%	Assume there exists a shortest path \\ 
%	$\gamma(x_a,x_b) = (x_a=x_{l_0},x_{l_1},\ldots,x_{l_{K-1}},x_{l_K} =x_b) $ 
%	from $x_a$ to $x_b$. \\
%	Then for each $k \leq K $
%	\begin{equation}
%	A^\kappa_{l_k a}  = 0  \quad \text{if }\kappa <k \tab{and} A^k_{l_k a} \neq 0
%	\quad .
%	\end{equation}
%\end{lemma}
%\begin{proof}
%	Note that each $\gamma(x_a,x_{l_k})\subset \gamma(x_a,x_b)$ hence it is a 
%	shortest path of length $k$. \\
%	\begin{itemize}
%	\item
%	Consider $\kappa < k$ and assume $A^\kappa_{l_k a}\neq 0$. Then by the previous 
%	lemma there exists a path from $x_a$ to $x_{l_k}$ of length $\kappa <k=
%	||\gamma(x_a,x_{l_k})||$, 
%	which is not possible, since $\gamma(x_a,x_{l_k})$ already is the shortest path.
%	 Therefore $A^\kappa_{l_k a}=0$.
%	\item	
%	Consider $\kappa = k$. Then we know that $\gamma(x_a,x_{l_k})$ is a path from 
%	$x_a$ to $x_{l_k}$ of length $k$, thus by the previous lemma $A^k_{l_k a}\neq 0$.  
%	\end{itemize}
%\end{proof}
%
%
%\clearpage
%%
%%\begin{proposition}{First nonzero column}{}
%%	Choose one $a\in \hat{D}$ and assume that
%%	\begin{equation}
%%	b = \text{arg} \underset{b'\in\hat{D}}{\min} || \gamma(x_{a},x_{b'}) || 
%%	\end{equation}
%%	exists. Since $a\in\hat{D}$ we know that $a=i_\alpha$ and $b=j_\beta$. 
%%	By construction the $\alpha$-th column of $D$ is $e_a$ and the $\beta$-th row of 
%%	$C$ is $e_b^\text{T}$. \\
%%	
%%	Then for each $\kappa < ||\gamma(x_a,x_b)||$
%%	\begin{equation}
%%	(CA^\kappa D)_{\mu \alpha} = 0 \quad \forall \mu\in\{1,2,\ldots,p \}
%%	\end{equation}
%%	and if $\kappa=||\gamma(x_a,x_b)||$ at least the component $\mu=\beta$ is nonzero.
%%\end{proposition}
%%\begin{proof}
%%	Let $x_a$ and $x_b$ be knots as defined above and $K:=||\gamma(x_a,x_b)||$.
%%	We write down
%%	\begin{equation}
%%	(CA^\kappa D)_{\mu \alpha} = \sum\limits_{\lambda, \rho=1}^n C_{\mu\lambda} 
%%	A^\kappa_{\lambda \rho} 
%%	D_{\rho \alpha} \quad .
%%	\end{equation}
%%	Note that $D_{\rho\alpha}$ is the Kronecker-delta $\delta_{\rho a}$ and that 
%%	the $\mu$-th row of $C$ is $e_{j_\mu}^\text{T}$, i.e. $C_{\mu \lambda} = 
%%	\delta_{\lambda {j_\mu}}$, thus
%%	\begin{equation}
%%	(CA^\kappa D)_{\mu \alpha} = A^\kappa_{j_\mu a}  \quad .
%%	\end{equation}
%%	\begin{itemize}
%%	\item
%%	Consider $\kappa <k$ and assume there is a $\mu$ such that $A^\kappa_{j_\mu a}\neq 0$. 
%%	Then there is a path from $x_a$ to the observed knot $x_{j_\mu}$ of length $\kappa$. 
%%	This is in contradiction to $\gamma(x_a,x_b)$ being the shortest path from $x_a$ to an 
%%	observed knot. Therefore $(CA^\kappa D)_{\mu\alpha}=0$.\\
%%	\item
%%	Now consider $\kappa = K$. Then the existence of $\gamma(x_a,x_b)$ ensures $A^k_{ba}
%%	\neq 0$ and since we can choose $\mu=\beta$ which means $j_\mu = b$ we know 
%%	that $A^k_{b a}\neq 0$ and therefore $(CA^kD)_{\beta\alpha}\neq 0$.
%%	\end{itemize}
%%\end{proof}
%%
%%
%%\begin{proposition}{First nonzero row}{}
%%	Choose one $b\in \hat{C}$ and assume that
%%	\begin{equation}
%%	a = \text{arg} \underset{a'\in\hat{D}}{\min} || \gamma(x_{a'},x_{b}) || 
%%	\end{equation}
%%	exists, i.e. there exists at least one path from at least the hidden input knot to the 	
%%	observed knot $x_b$. Since $a\in\hat{D}$ we know that $a=i_\alpha$ and $b=j_\beta$. 
%%	By construction the $\alpha$-th column of $D$ is $e_a$ and the $\beta$-th row of 
%%	$C$ is $e_b^\text{T}$. \\
%%	
%%	Then for each $\kappa < ||\gamma(x_a,x_b)||$
%%	\begin{equation}
%%	(CA^\kappa D)_{\beta\mu} = 0 \quad \forall \mu\in\{1,2,\ldots,m \}
%%	\end{equation}
%%	and if $\kappa=||\gamma(x_a,x_b)||$ at least the component $\mu=\alpha$ is nonzero.
%%\end{proposition}
%%\begin{proof}
%%	The proof is analogous to the latter proof. \\
%%	
%%	Let $x_a$ and $x_b$ be knots as defined above and $K:=||\gamma(x_a,x_b)||$.
%%	We write down
%%	\begin{equation}
%%	(CA^\kappa D)_{\beta \mu} = \sum\limits_{\lambda, \rho=1}^n C_{\beta\lambda} 
%%	A^\kappa_{\lambda \rho} 
%%	D_{\rho \mu} \quad .
%%	\end{equation}
%%	Note that this time $C_{\beta\lambda}$ is the Kronecker-delta $\delta_{b \lambda}$ and 
%%	that the $\mu$-th column of $D$ is $e_{i_\mu}^\text{T}$, i.e. $D_{\rho \mu} = 
%%	\delta_{\rho {i_\mu}}$, thus
%%	\begin{equation}
%%	(CA^\kappa D)_{\mu \alpha} = A^\kappa_{b i_\mu}  \quad .
%%	\end{equation}
%%	\begin{itemize}
%%	\item
%%	Consider $\kappa <k$ and assume there is a $\mu$ such that $A^\kappa_{b i_\mu}\neq 0$. 
%%	Then there is a path from the input knot $x_{i_\mu}$ to $x_b$ of length $\kappa$. 
%%	This is in contradiction to $\gamma(x_a,x_b)$ being the shortest path from an input 
%%	knot to $x_b$. Therefore $(CA^\kappa D)_{\beta\mu}=0$.\\
%%	\item
%%	Now consider $\kappa = K$. Then the existence of $\gamma(x_a,x_b)$ ensures $A^k_{ba}
%%	\neq 0$ and since we can choose $\mu=\alpha$ which means $i_\mu = a$ we know 
%%	that $A^k_{b a}\neq 0$ and therefore $(CA^kD)_{\beta\alpha}\neq 0$. 
%%	\end{itemize}
%%\end{proof}
%
%\begin{proposition}{}{}
%	Let $x_a$ and $x_b$ be a hidden input knot and an observed knot, respectively. We can 
%	write $a=i_\alpha$ and $b=j_\beta$ for an $\alpha\in\{1,2,\ldots,m\}$ and 
%	$\beta\in\{1,2,\ldots,p\}$.\\
%	Then
%	\begin{equation}
%	(CA^kD)_{\beta\alpha} \neq 0 \quad \Leftrightarrow \quad \exists \text{ a path from }
%	x_a \text{ to } x_b \text{ of length }k \quad . 
%\end{equation}		
%	As a corollary, assume $\gamma(x_a,x_b)$ exists and is of length $K$.
%	\begin{equation}
%	(CA^kD)_{\beta\alpha} = 0 \quad \text{for }k<K \tab{and} (CA^KD)_{\beta\alpha}\neq 0 
%	\quad .
%	\end{equation}
%	
%\end{proposition}
%\begin{proof}
%	We write as a sum
%	\begin{equation}
%	(CA^k D)_{\beta\alpha} = \sum\limits_{\lambda,\rho=1}^n C_{\beta \lambda} A^k_{\lambda
%	\rho} D_{\rho \alpha} = A^k_{ba} \quad .
%	\end{equation}
%	Now we can simply apply lemma 7 and lemma 8 to finish the proof.
%\end{proof}

Our aim is to get information about the matrices $M_q$ and the sets $V_q$, so that we can 
apply the HIO theorem, just by properties of the influence graph.
\begin{proposition}{}{}
	In the situation described above
	\begin{equation}
	(CA^kD)_{\beta\alpha} = F\left( \Gamma_k(w_\alpha,y_\beta) 
	\right)
	\end{equation}
	where the path factor $F$ of a set is understood as the sum over the path factors of all 
	elements and $\Gamma_k(w_\alpha,y\beta)$ is understood as the set of all paths in 
	$\Gamma_k(x_a,x_b)$ where $a\in\hat{D}_\alpha$ and $b\in\hat{C}_\beta$.
\end{proposition}
\begin{proof}
	At first note that
	\begin{equation}
	A^k_{ba} = \sum\limits_{\pi\in\Gamma_k(x_a,x_b) } F(\pi) \quad .
	\end{equation}
	This becomes obvious when we write
	\begin{equation}
	A^k_{ba} = \sum\limits_{l_1,l_2,\ldots,l_{k-1}=1}^n
	A_{bl_{k-1}} \ldots A_{l_2,l_1}  A_{l_1a}
	\end{equation}
	and note that the right hand side is just the sum over $F((x_a,x_{l_1},\ldots ,x_b))$ 
	with all possible values of $l_1,\ldots,l_{k-1}$. As already seen $F(\pi)=0$ is zero 
	if $\pi$ is not a path. Thus all sequences $(x_a,\ldots,x_b)$ that give a nonzero 
	path factor are paths of length $k$.\\
	
	For simplicity we assume that $w_\alpha$ hits $x_a$. We find
	\begin{equation}
	(CA^kD)_{\beta\alpha} = \sum\limits_{\lambda,\rho = 1}^n C_{\beta\lambda}A^k_{\lambda\rho} 
	D_{\rho\alpha} 
	= \sum\limits_{a\in\hat{D}_\alpha}\sum\limits_{b\in\hat{C}_\beta} A^k_{ba} \quad .
	\end{equation}
	By construction the $\alpha$-th column of $D$ is $1$ if $\rho\in \hat{D}_\alpha$ 
	and $0$ else. The $\beta$-th row of $C$ gives 
	$C_{\beta\lambda}=1$ if $\lambda\in\hat{C}_\beta$ and zero else.\\
	
	Finally
	\begin{equation}
	(CA^kD)_{\beta\alpha} =\sum\limits_{a\in\hat{D}_\alpha}
	 \sum\limits_{b\in\hat{C}_\beta}\sum\limits_{\pi\in\Gamma_k(x_a,x_b)} F(\pi) 
	\end{equation}
	which is the right hand side of the proposition.
\end{proof}

Note that this proposition can easily be extended to the case of general matrices $D$ and 
$C$ by multiplying $F$ with some factors. On the other hand we can simplify the proposition 
by using $F$ as the indicator that gives $0$ if the set is empty and $1$ if not.\\


\begin{definition}{}{}
	Define 
	\begin{equation}
	K_i := \min\limits_{\alpha\in\{1,\ldots,m\}} d(w_\alpha,y_i)
	\end{equation}
	i.e. the length of the shortest path from any knot that is affected by a hidden input 
	to a knot that affects the observable $y_i$. Furthermore
	\begin{equation}
	\Xi := \begin{pmatrix}
	F\left(\Gamma_{K_1}(w_1,y_1) \right) & F\left(\Gamma_{K_1}(w_2,y_1) \right) & \ldots \\
	F\left(\Gamma_{K_2}(w_1,y_2) \right) & F\left(\Gamma_{K_2}(w_2,y_2) \right) & \ldots \\
	\vdots & \ddots & \ddots
	\end{pmatrix} \quad .
	\end{equation}
	If $\Xi$ is injective, then the system is called \textit{structural hidden input 
	observable}.
\end{definition}

\begin{theorem}{}{}
	If a system is structural HIO, then it is HIO for almost all parameter settings.
\end{theorem}
\begin{proof}
	Without loss of generality $K_1\leq K_2 \leq \ldots\leq K_p$. We write the 
	matrices $M_k$ in rows for an appropriate $k$,
	\begin{equation}
	M_k = \begin{bmatrix}
	\begin{pmatrix} 0 \\ 0 \\ 0 \\ \vdots \end{pmatrix} &
	\begin{pmatrix} \hdots \\ \hdots \\ \hdots \\ \vdots \end{pmatrix}&
	\begin{pmatrix} (CA^{K_1}D)_{1.} \\ 0 \\ 0 \\ \vdots \end{pmatrix} &
		\begin{pmatrix} \hdots \\ \hdots \\ \hdots \\ \vdots \end{pmatrix} & 
	\begin{pmatrix} (C A^{K_2} D)_{1.} \\ (CA^{K_2}D)_{2.} \\ 0 \\ \vdots \end{pmatrix} &
		\begin{pmatrix} \hdots \\ \hdots \\ \hdots \\ \vdots \end{pmatrix} &
	\begin{pmatrix} (CA^{K_3}D)_{1.} \\ (CA^{K_3}D)_{2.} \\ (CA^{K_3}D)_{3.} 
	\\ \vdots \end{pmatrix} &
	\end{bmatrix} \label{eq:M_q_in_rows}
	\end{equation}
	We deduce 
	\begin{equation}
	V_0 = \mathbb{R}^m \tab{and} V_k = \mathbb{R}^{(k+1)m} \quad \text{for}\, k<K_1
	\end{equation}
	since $M_k$ consists only of zeroes. Then from the first row we get
	\begin{equation}
	V_{K_1} = \mathbb{R}^{K_1m} \times \left\{\xi\in \mathbb{R}^m \big| \sum\limits_{l=1}^m 
	\xi_l (CA^{K_1}D)_{1l} = 0 \right\}
	\end{equation}
	and 
	\begin{equation}
	P^{K_1} V_{K_1} = \left\{\xi\in \mathbb{R}^m \big| \sum\limits_{l=1}^m 
	\xi_l F\left(\Gamma_{K_1}(w_l,y_1)\right) = 0 \right\} .
	\end{equation}
	From the second row we get 
	\begin{equation}
	P^{K_2}V_{K_2} \subseteq \left\{\xi\in \mathbb{R}^m \big| \sum
	\limits_{l=1}^m \xi_l F\left( \Gamma_{K_2}(w_l,y_2) \right) = 0 \right\}
	\end{equation}
	and so on. Note that we neglect the information in the $(\hdots)$ parts of equation 
	\eqref{eq:M_q_in_rows}, therefore the condition we get will be sufficient but not 
	necessary.\\
	
	Now we see that 
	\begin{equation}
	\mathfrak{O}_0 \subseteq  \bigcap\limits_{r=1}^p P^{K_r}V_{K_r} \subseteq \bigcap_{r=1}^p 
	\left\{\xi\in \mathbb{R}^m \big| \sum\limits_{l=1}^m 
	\xi_l F\left( \Gamma_{K_r} (w_l,y_r) \right) = 0 \right\}
	\end{equation}
	and the right hand side of the latter equation is exactly
	\begin{equation}
	\left\{\xi\in \mathbb{R}^m \big| \sum\limits_{l=1}^m 
	\Xi \xi = 0 \right\} \quad .
	\end{equation}
	Thus $\Xi$ is injective leads to $\mathfrak{O}_0=\{0\}$ which is sufficient for HIO.
\end{proof}
